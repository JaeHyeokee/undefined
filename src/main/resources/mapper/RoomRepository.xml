<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.lec.spring.repository.RoomRepository">
    <insert id="create" flushCache="true" parameterType="com.lec.spring.domain.Room"
            useGeneratedKeys="true" keyColumn="id" keyProperty="id">
        INSERT INTO room
            (room_id, room_picture_1, room_picture_2, room_picture_3, room_name, room_normal_people, room_max_people
            , room_price, room_number, room_area, room_bed, room_bed_grade, room_bathroom, room_smoke)
        VALUES
            (#{room_id}, #{room_picture_1}, #{room_picture_2}, #{room_picture_3}, #{room_name}, #{room_normal_people}, #{room_max_people}
            , #{room_price}, #{room_number}, #{room_area}, #{room_bed}, #{room_bed_grade}, #{room_bathroom}, #{room_smoke})
    </insert>

    <sql id="SELECT_BASE">
        SELECT r.room_id
             , r.room_picture_1
             , r.room_picture_2
             , r.room_picture_3
             , r.room_name
             , r.room_normal_people
             , r.room_max_people
             , r.room_price
             , r.room_number
             , r.room_area
             , r.room_bed
             , r.room_bed_grade
             , r.room_bathroom
             , r.room_smoke
             , r.lodging_id
        FROM
            room r, lodging l
        WHERE
            r.lodging_id = l.lodging_id
    </sql>

    <resultMap id="mapRoom" type="com.lec.spring.domain.Room">
        <id property="roomId" column="room_id"/>
        <result property="roomPicture1" column="room_picture_1"/>
        <result property="roomPicture2" column="room_picture_2"/>
        <result property="roomPicture3" column="room_picture_3"/>
        <result property="roomName" column="room_name"/>
        <result property="roomNormalPeople" column="room_normal_people"/>
        <result property="roomMaxPeople" column="room_max_people"/>
        <result property="roomPrice" column="room_price"/>
        <result property="roomNumber" column="room_number"/>
        <result property="roomArea" column="room_area"/>
        <result property="roomBed" column="room_bed"/>
        <result property="roomBedGrade" column="room_bed_grade"/>
        <result property="roomBathroom" column="room_bathroom"/>
        <result property="roomSmoke" column="room_smoke"/>
        <result property="lodgingId" column="lodging_id"/>
    </resultMap>

    <select id="findAll" resultMap="mapRoom">
        <include refid="SELECT_BASE"/>
        ORDER BY r.room_id
    </select>

    <select id="findByRoomId" resultMap="mapRoom">
        <include refid="SELECT_BASE"/>
        AND r.room_id = #{room_id}
    </select>

    <select id="findByLodgingId" resultMap="mapRoom">
        <include refid="SELECT_BASE"/>
        AND r.lodging_id = #{lodging_id}
    </select>

    <update id="update" flushCache="true" parameterType="com.lec.spring.domain.Room">
        UPDATE room
        SET room_picture_1 = #{room_picture_1}
          , room_picture_2 = #{room_picture_2}
          , room_picture_3 = #{room_picture_3}
          , room_name = #{room_name}
          , room_normal_people = #{room_normal_people}
          , room_max_people = #{room_max_people}
          , room_price = #{room_price}
          , room_number = #{room_number}
          , room_area = #{room_area}
          , room_bed = #{room_bed}
          , room_bed_grade = #{room_bed_grade}
          , room_bathroom = #{room_bathroom}
          , room_smoke = #{room_smoke}
        WHERE room_id = #{room_id}
    </update>

    <delete id="delete" flushCache="true" parameterType="com.lec.spring.domain.Room">
        DELETE FROM room WHERE room_id = #{room_id}
    </delete>

    <!--페이징 용 쿼리-->
<!--    <select id="selectFromRow" resultMap="mapPost">-->
<!--        <include refid="SELECT_BASE"/>-->
<!--        ORDER BY p.id DESC-->
<!--        LIMIT #{param1}, #{param2}-->
<!--    </select>-->

<!--    <select id="countAll" resultType="int">-->
<!--        SELECT count(*) FROM t5_post;-->
<!--    </select>-->
</mapper>